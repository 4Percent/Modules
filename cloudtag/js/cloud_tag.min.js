!function(t){function e(){}function s(){var t=this,e={},s=2e-4,i=!1;this.speedX=0,this.speedY=0,this.speedZ=0,this.isRotating=!1,this.minSpeed=.001,f(this.con,"mouseenter",function(t){e.x=t.offsetX,e.y=t.offsetY}),f(this.con,"mousemove",function(o){a&&!i&&(e.x=o.offsetX,e.y=o.offsetY,i=!0),t.speedY-=(o.offsetX-e.x)*s,t.speedX-=(o.offsetY-e.y)*s,e.x=o.offsetX,e.y=o.offsetY,t.isRotating||(t.isRotating=!0,t.rotateSphere())},!1),a&&f(this.con,"mouseleave",function(t){i=!1});for(var o=0;o<this.points.length;o++)f(this.points[o],"mousemove",function(t){t.cancelBubble=!0}),f(this.points[o],"mouseenter",function(t){t.cancelBubble=!0})}function i(t,e,s){this.con=t,this.r=e,this.perspective=s,this.points=t.children,this.centerX=this.con.offsetWidth/2,this.centerY=this.con.offsetHeight/2,this.init()}function o(t,e){this.con=t,this.points=t.children,this.r=e,this.centerX=this.con.offsetWidth/2,this.centerY=this.con.offsetHeight/2,this.init()}function n(t,e){this.con=t,this.r=e.r,this.detectR=e.detectR||1.2*this.r,this.perspective=e.perspective||1e3,this.points=e.points,this.ctx=t.getContext("2d"),this.centerX=e.centerX,this.centerY=e.centerY,this.init()}var h=Math.sin,r=Math.cos,c=Math.PI,a=/Trident|Edge/.test(t.navigator.userAgent),p=t.getComputedStyle?function(e,s){return t.getComputedStyle(e,"")[s]}:function(t,e){return t.currentStyle[e]},f=t.addEventListener?function(t,e,s){t.addEventListener(e,s,!1)}:function(e,s,i){e.attachEvent("on"+s,function(){var s,o=t.event;o.preventDefault=function(){s=!1},i.call(e,o)})},l=t.requestAnimationFrame?function(e){return t.requestAnimationFrame(e)}:function(e){return t.setTimeout(e,20)};e.prototype={constructor:e,init:function(){this.locs=[],this.clearDefaultEvent(),this.distribute(),this.enableRotate()},clearDefaultEvent:function(){f(this.con,"mousedown",function(t){t.preventDefault()})},distribute:function(){for(var t,e,s,i=0;i<this.points.length;i++)s=this.points[i],t=Math.acos((2*i+1)/this.points.length-1),e=Math.sqrt(this.points.length*c)*t,this.locs[i]={},this.locs[i].z=this.r*r(t),this.locs[i].x=this.r*h(t)*r(e),this.locs[i].y=this.r*h(t)*h(e),this.locs[i].idx=i,this.initAttrs(s,this.locs[i]);this.resolvePos()},rotateSphere:function(){var t=this;this.updateLocs(),this.resolvePos(),this.speedX*=.98,this.speedY*=.98,Math.abs(this.speedX)>this.minSpeed||Math.abs(this.speedY)>this.minSpeed?l(function(){t.rotateSphere()}):this.isRotating=!1},updateLocs:function(){for(var t,e,s,i,o,n,c,a,p,f=0;f<this.locs.length;f++)p=this.locs[f],t=r(this.speedZ),e=h(this.speedZ),s=t*p.x-e*p.y,i=e*p.x+t*p.y,t=r(this.speedX),e=h(this.speedX),o=t*i-e*p.z,n=e*i+t*p.z,t=r(this.speedY),e=h(this.speedY),c=t*s-e*n,a=e*s+t*n,p.x=c,p.y=o,p.z=a}},i.prototype=new e,i.prototype.constructor=i,i.prototype.initAttrs=function(t,e){e.w=t.offsetWidth,e.h=t.offsetHeight,e.fs=parseFloat(p(t,"fontSize"))},i.prototype.resolvePos=function(){var t,e,s,i,o;this.locs.sort(function(t,e){return t.z-e.z});for(var n=0;n<this.locs.length;n++)e=this.locs[n],t=this.points[e.idx],s=this.perspective/(this.perspective-e.z),t.style.zIndex=n,o=s*e.w,i=s*e.h,t.style.left=this.centerX+e.x-o/2+"px",t.style.top=this.centerY+e.y-i/2+"px",t.style.height=i+"px",t.style.width=o+"px",t.style.fontSize=s*e.fs+"px"},i.prototype.enableRotate=s;e.prototype.distribute;o.prototype=new e,o.prototype.initAttrs=function(t,e){t.style.left=this.centerX-t.offsetWidth/2+"px",t.style.top=this.centerY-t.offsetHeight/2+"px"},o.prototype.resolvePos=a?function(){var t,e;this.locs.sort(function(t,e){return t.z-e.z});for(var s=0;s<this.locs.length;s++)e=this.locs[s],t=this.points[e.idx],t.style.transform="translate3d("+e.x+"px,"+e.y+"px,"+e.z+"px)",t.style.zIndex=s}:function(){for(var t,e,s=0;s<this.locs.length;s++)e=this.locs[s],t=this.points[e.idx],t.style.transform="translate3d("+e.x+"px,"+e.y+"px,"+e.z+"px)"},o.prototype.enableRotate=s;var u=e.prototype.init,d=e.prototype.rotateSphere;n.prototype=new e,n.prototype.init=function(){var t,e=this,s=!1;this.imgs=[],this.imgsCount=0,this.loadedCount=0,this.ctx.textAlign="center",this.ctx.textBaseline="middle";for(var i=0;i<this.points.length;i++)t=this.points[i],t.src&&(s=!0,this.imgsCount++,this.imgs[i]=new Image,this.imgs[i].src=t.src,this.imgs[i].onload=function(){++e.loadedCount===e.imgsCount&&u.call(e)});this.angleS=c/5,this.angleL=c/5*2,s||u.call(this)},n.prototype.initAttrs=function(t,e){t.fs=t.fs||16,t.hbg=t.hbg||t.bg,t.color=t.color||"#000"},n.prototype.drawStarPath=function(t,e,s,i){var o,n;this.ctx.moveTo(t,e-s);for(var c=0;5>c;c++)o=this.angleS+this.angleL*c,n=this.angleL*(c+1),this.ctx.lineTo(t+h(o)*i,e-r(o)*i),this.ctx.lineTo(t+h(n)*s,e-r(n)*s);return this.ctx.isPointInPath(this.mouseX,this.mouseY)},n.prototype.drawHexaPath=function(t,e,s){var i;this.ctx.moveTo(t+s,e);for(var o=1;7>o;o++)i=o*c/3,this.ctx.lineTo(t+r(i)*s,e+h(i)*s);return this.ctx.isPointInPath(this.mouseX,this.mouseY)},n.prototype.rotateSphere=function(){this.ctx.clearRect(0,0,this.con.width,this.con.height),d.call(this)},n.prototype.findClosest=function(){var t,e,s,i,o,n,h,r,a=-this.r-1;this.locs.sort(function(t,e){return t.z-e.z});for(var p=this.locs.length-1;p>=0;p--)switch(e=this.locs[p],t=this.points[e.idx],s=this.perspective/(this.perspective-e.z),i=e.x+this.centerX,o=e.y+this.centerY,this.ctx.beginPath(),t.type){case"image":n=t.w*s,h=t.w*s,this.ctx.drawImage(this.imgs[e.idx],i-n/2,o-h/2,n,h),this.mouseX>i-n/2&&this.mouseX<i+n/2&&this.mouseY>o-h/2&&this.mouseY<o+h/2&&e.z>a&&(r=t,a=e.z);break;case"rect":n=t.w*s,h=t.h*s,this.ctx.rect(i-n/2,o-h/2,n,h),this.ctx.isPointInPath(this.mouseX,this.mouseY)&&e.z>a&&(r=t,a=e.z);break;case"round":n=t.r*s,this.ctx.arc(i,o,n,0,2*c,!1),this.ctx.isPointInPath(this.mouseX,this.mouseY)&&e.z>a&&(r=t,a=e.z);break;case"star":n=t.outerR*s,h=t.innerR*s,this.drawStarPath(i,o,n,h)&&e.z>a&&(r=t,a=e.z);break;case"hexagon":n=t.r*s,this.drawHexaPath(i,o,n)&&e.z>a&&(r=t,a=e.z)}this.hovered=r},n.prototype.judgeHover=function(t){this.ctx.fillStyle=this.hovered===t?t.hbg:t.bg},n.prototype.resolvePos=function(){var t,e,s,i,o,n,h;this.findClosest();for(var r=0;r<this.locs.length;r++){switch(e=this.locs[r],t=this.points[e.idx],s=this.perspective/(this.perspective-e.z),i=e.x+this.centerX,o=e.y+this.centerY,this.ctx.beginPath(),t.type){case"image":n=t.w*s,h=t.w*s,this.ctx.drawImage(this.imgs[e.idx],i-n/2,o-h/2,n,h),this.hovered===t&&(this.ctx.fillStyle="rgba(255,255,255,.3)",this.ctx.fillRect(i-n/2,o-h/2,n,h));break;case"rect":n=t.w*s,h=t.h*s,this.judgeHover(t),this.ctx.fillRect(i-n/2,o-h/2,n,h);break;case"round":n=t.r*s,this.ctx.arc(i,o,n,0,2*c,!1),this.judgeHover(t),this.ctx.fill();break;case"star":n=t.outerR*s,h=t.innerR*s,this.drawStarPath(i,o,n,h),this.judgeHover(t),this.ctx.fill();break;case"hexagon":n=t.r*s,this.drawHexaPath(i,o,n),this.judgeHover(t),this.ctx.fill()}t.text&&(this.ctx.fillStyle=t.color,this.ctx.font=t.fs*s+"px a",this.ctx.fillText(t.text,i,o))}},n.prototype.enableRotate=function(){var t=this,e={};this.isEntered=!1,this.speedX=0,this.speedY=0,this.speedZ=0,this.speedFactor=2e-4,this.isRotating=!1,this.minSpeed=.001,this.con.addEventListener("mousemove",function(s){var i=s.offsetX-t.centerX,o=s.offsetY-t.centerY;i*i+o*o<t.detectR*t.detectR?this.isEntered?(t.mouseX=s.offsetX,t.mouseY=s.offsetY,t.speedX-=(s.offsetY-e.y)*t.speedFactor,t.speedY-=(s.offsetX-e.x)*t.speedFactor,e.x=s.offsetX,e.y=s.offsetY,t.isRotating||(t.isRotating=!0,t.rotateSphere())):(this.isEntered=!0,e={x:s.offsetX,y:s.offsetY}):(this.isEntered=!1,t.mouseX=null,t.mouseY=null)},!1),this.con.addEventListener("click",function(){t.hovered&&t.hovered.handler&&t.hovered.handler()},!1)},t.CloudTag=i,t.CloudTagCss3=o,t.CloudTagCanvas=n}(window);